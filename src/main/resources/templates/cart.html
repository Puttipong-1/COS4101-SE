<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>ยืนยันการสั่งชื้อสินค้า</title>
    <link th:href="@{/css/bootstrap.css}" rel="stylesheet">
</head>
<body>
<div th:insert="fragments/headerLogin.html"></div>
<div class="container" style="margin-top: 10px">
    <div class="row mt-5">
        <div class="col-8 d-flex justify-content-center">
            <table class="table">
                <tbody>
                    <tr th:each="c:${customer.carts}">
                        <td><a th:href="${@environment.getProperty('aws.s3.url')}+${c.product.objectKey}"><img th:src="@{/image/{code}(code=${c.product.objectKey})}" width="100" height="100"></a></td>
                        <td th:text="${c.product.name}"></td>
                        <td th:text="${c.product.price}+' บาท'"></td>
                        <td th:text="${c.quantity}+' ชิ้น'"></td>
                        <td th:text="${c.sumPrice}+' บาท'"></td>
                        <td><form action="/removecart" method="post">
                                <input type="hidden" th:name="customer" th:value="${c.customer.customerId}">
                                <input type="hidden" th:name="product" th:value="${c.product.productId}">
                                <input type="submit" class="btn btn-link" value="ลบ">
                        </form></td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="col-4 d-block justify-content-center">
            <h1 class="text-center">สรุปข้อมูลการสั่งชื้อ</h1>
            <div class="row">
                <div class="col-6 text-left">
                    <span>จำนวนสินค้าทั้งหมด</span>
                </div>
                <div class="col-6 text-right">
                    <span th:text="${quantity}+' ชิ้น'"></span>
                </div>
            </div>
            <div class="row">
                <div class="col-6 text-left">
                    <span>ราคารวมสินค้า</span>
                </div>
                <div class="col-6 text-right">
                    <span th:text="${total}+' บาท'"></span>
                </div>
            </div>
            <div class="row">
                <div class="col-6 text-left">
                    <span>ค่าส่ง</span>
                </div>
                <div class="col-6 text-right">
                    <span th:text="${delivery}+ ' บาท'"></span>
                </div>
            </div>
            <div class="row">
                <div class="col-6 text-left">
                    <span>ราคารวมทั้งหมด</span>
                </div>
                <div class="col-6 text-right">
                    <span th:text="${totalOrder}+' บาท'"></span>
                </div>
            </div>
            <div>
                <span class="font-weight-bold">ที่อยู่</span><br>
               <span th:text="${customer.getFullAddress()}"></span>
            </div>
            <form method="post" th:object="${customer}" action="/makeorder">
                <input type="hidden" th:field="*{customerId}" th:value="${customer.customerId}">
                <div th:each="cart,itr:${customer.carts}">
                    <input type="hidden" th:field="*{carts[__${itr.index}__].product.productId}"
                           th:value="${cart.product.productId}">
                    <input type="hidden" th:field="*{carts[__${itr.index}__].quantity}"
                    th:value="${cart.quantity}">
                    <input type="hidden" th:field="*{carts[__${itr.index}__].sumPrice}"
                           th:value="${cart.sumPrice}">
                </div>
                <input type="hidden" th:name="total_quan" th:value="${quantity}">
                <input type="hidden" th:name="total_price" th:value="${total}">
                <input type="submit" class="btn btn-primary text-center justify-content-center"
                       th:disabled="${customer.carts.isEmpty()}"
                       onclick="return checkTime()" value="สั่งชื้อ">
            </form>
        </div>
    </div>
    </div>
</div>
<div th:include="fragments/modaltime.html"></div>
<script src="https://unpkg.com/spacetime"></script>
<script type="text/javascript" src="https://unpkg.com/rmodal/dist/rmodal.js"></script>
<script th:src="@{/js/validate.js}" type="text/javascript"></script>
</body>
</html>